import{j as e}from"./query-BJLVRUEZ.js";import{u as le,r as u,a as he}from"./router-BVXzBWz1.js";import{u as T,a as ce,b as Q,L as O,C as p,c as v,B,d as D,e as A,f as M,s as R,g as ue,h as de,i as oe,v as je,j as Y,k as ge,l as pe,m as Z,n as G,o as fe,M as ve,I as K,p as xe,q as ye,r as be,t as Ne}from"./admin-DUsXwUKW.js";const ee=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253z"})}),we=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),se=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),ke=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})});function He(){const x=le(),[y,i]=u.useState(null),{data:a,isLoading:n}=T(),{data:t,isLoading:h}=ce(),{data:g}=Q((a==null?void 0:a.id)||""),b=[{label:"ëŒ€ì‹œë³´ë“œ",href:"/student",icon:e.jsx(ee,{})},{label:"AI ì±„íŒ…",href:"/student/chat",icon:e.jsx(we,{})},{label:"ë‚´ í”„ë¡œí•„",href:"/student/profile",icon:e.jsx(se,{})},{label:"í™œë™ ê¸°ë¡",href:"/student/history",icon:e.jsx(ke,{})}],d=r=>{switch(r){case"argumentation":return"ë…¼ì¦ í™œë™";case"discussion":return"í† ë¡  í™œë™";case"experiment":return"ì‹¤í—˜ í™œë™";default:return r}},_=r=>{switch(r){case"argumentation":return"info";case"discussion":return"warning";case"experiment":return"success";default:return"default"}};return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):e.jsxs(O,{title:`ì•ˆë…•í•˜ì„¸ìš”, ${(a==null?void 0:a.name)||"í•™ìƒ"}ë‹˜!`,subtitle:"ì˜¤ëŠ˜ë„ ì¦ê±°ìš´ í•™ìŠµ ë˜ì„¸ìš”",sidebarItems:b,showSidebar:!0,children:[e.jsx("div",{className:"mb-8",children:e.jsx(p,{children:e.jsx(v,{children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(se,{})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:a==null?void 0:a.name}),e.jsxs("p",{className:"text-gray-600",children:["í•™ë²ˆ: ",a==null?void 0:a.student_id]}),e.jsxs("p",{className:"text-gray-600",children:["ë°˜: ",(a==null?void 0:a.class_name)||"ë¯¸ì§€ì •"]})]}),e.jsx("div",{className:"ml-auto",children:e.jsx(B,{variant:"success",children:"ì˜¨ë¼ì¸"})})]})})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(p,{children:e.jsx(v,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(t==null?void 0:t.length)||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì‚¬ìš© ê°€ëŠ¥í•œ í™œë™"})]})})}),e.jsx(p,{children:e.jsx(v,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(g==null?void 0:g.length)||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"AI ì±„íŒ… ê¸°ë¡"})]})})}),e.jsx(p,{children:e.jsx(v,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"0"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ì™„ë£Œí•œ í™œë™"})]})})})]}),e.jsxs(p,{children:[e.jsx(D,{children:e.jsx(A,{children:"ì‚¬ìš© ê°€ëŠ¥í•œ í™œë™"})}),e.jsx(v,{children:h?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"í™œë™ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]}):t&&t.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(r=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>i(r.id),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:r.title}),e.jsx(B,{variant:_(r.type),size:"sm",children:d(r.type)})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:r.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"ì§„í–‰ë¥ : 0%"}),e.jsx(M,{size:"sm",onClick:w=>{w.stopPropagation(),x(`/student/activity/${r.id}`)},children:"ì‹œì‘í•˜ê¸°"})]})]},r.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ee,{}),e.jsx("p",{className:"text-gray-500 mt-2",children:"í˜„ì¬ ì‚¬ìš© ê°€ëŠ¥í•œ í™œë™ì´ ì—†ìŠµë‹ˆë‹¤."})]})})]}),g&&g.length>0&&e.jsxs(p,{className:"mt-6",children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(A,{children:"ìµœê·¼ AI ì±„íŒ…"}),e.jsx(M,{variant:"outline",size:"sm",onClick:()=>x("/student/chat"),children:"ì „ì²´ ë³´ê¸°"})]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-4",children:g.slice(-3).map(r=>e.jsxs("div",{className:"border-l-4 border-primary-200 pl-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:new Date(r.created_at).toLocaleString()}),e.jsx("p",{className:"text-gray-900 font-medium mb-2",children:r.message}),e.jsxs("p",{className:"text-gray-600 text-sm",children:[r.response.substring(0,100),"..."]})]},r.id))})})]})]})}function me({activityId:x,className:y}){const[i,a]=u.useState(""),[n,t]=u.useState([]),[h,g]=u.useState(!1),[b,d]=u.useState(!1),_=u.useRef(null),r=u.useRef(null),{data:w}=T(),{data:z,isLoading:o}=Q((w==null?void 0:w.id)||"",x);u.useEffect(()=>{if(z){const f=[];z.forEach(S=>{f.push({id:`${S.id}-user`,content:S.message,isUser:!0,timestamp:S.created_at}),f.push({id:`${S.id}-ai`,content:S.response,isUser:!1,timestamp:S.created_at})}),t(f)}},[z]);const j=()=>{var f;(f=_.current)==null||f.scrollIntoView({behavior:"smooth"})};u.useEffect(()=>{j()},[n]);const k=async()=>{if(!i.trim()||!w||h)return;const f={id:`user-${Date.now()}`,content:i,isUser:!0,timestamp:new Date().toISOString()};t(L=>[...L,f]);const S=i;a(""),g(!0);const F={id:`ai-${Date.now()}`,content:"",isUser:!1,timestamp:new Date().toISOString(),isStreaming:!0};t(L=>[...L,F]);try{r.current=new AbortController;const L=await R.functions.invoke("ai-chat",{body:{message:S,studentId:w.id,activityId:x,useRag:b,stream:!1},signal:r.current.signal});if(L.error)throw new Error(L.error.message||"AI ì‘ë‹µ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");t(P=>P.map(m=>m.id===F.id?{...m,content:L.data.response,isStreaming:!1}:m))}catch(L){console.error("Error sending message:",L);const P=L.name==="AbortError"?"ë©”ì‹œì§€ ì „ì†¡ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.":"ì£„ì†¡í•©ë‹ˆë‹¤. ë©”ì‹œì§€ ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";t(m=>m.map(s=>s.id===F.id?{...s,content:P,isStreaming:!1}:s))}finally{g(!1),r.current=null}},$=()=>{r.current&&r.current.abort()},c=f=>{f.key==="Enter"&&!f.shiftKey&&(f.preventDefault(),k())},C=()=>{window.confirm("ì±„íŒ… ê¸°ë¡ì„ ëª¨ë‘ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?")&&t([])};return o?e.jsx(p,{className:y,children:e.jsxs("div",{className:"flex items-center justify-center h-96",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"ì±„íŒ… ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]})}):e.jsx(p,{className:y,padding:"none",children:e.jsxs("div",{className:"flex flex-col h-96",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"AI í•™ìŠµ ë„ìš°ë¯¸"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("label",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:f=>d(f.target.checked),className:"mr-1 h-3 w-3 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),"ë¬¸ì„œ ê²€ìƒ‰"]}),e.jsx(M,{variant:"outline",size:"sm",onClick:C,disabled:n.length===0,children:"ê¸°ë¡ ì§€ìš°ê¸°"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.length===0?e.jsxs("div",{className:"text-center text-gray-500 mt-8",children:[e.jsx("div",{className:"mb-4",children:e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),e.jsx("p",{className:"text-lg font-medium",children:"AIì™€ ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”!"}),e.jsx("p",{className:"text-sm mt-2",children:"ê¶ê¸ˆí•œ ê²ƒì´ ìˆìœ¼ë©´ ì–¸ì œë“  ë¬¼ì–´ë³´ì„¸ìš”."}),e.jsx("div",{className:"mt-4 text-xs text-gray-400",children:e.jsx("p",{children:"ğŸ’¡ íŒ: êµ¬ì²´ì ì¸ ì§ˆë¬¸ì„ í•˜ë©´ ë” ë„ì›€ì´ ë˜ëŠ” ë‹µë³€ì„ ë°›ì„ ìˆ˜ ìˆì–´ìš”"})})]}):n.map(f=>e.jsx("div",{className:`flex ${f.isUser?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${f.isUser?"bg-primary-600 text-white":"bg-gray-100 text-gray-900"}`,children:[e.jsxs("div",{className:"text-sm whitespace-pre-wrap",children:[f.content,f.isStreaming&&e.jsx("span",{className:"inline-block w-2 h-4 bg-current animate-pulse ml-1"})]}),e.jsx("div",{className:"text-xs mt-1 opacity-70",children:new Date(f.timestamp).toLocaleTimeString()})]})},f.id)),e.jsx("div",{ref:_})]}),e.jsxs("div",{className:"border-t border-gray-200 p-4",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("textarea",{value:i,onChange:f=>a(f.target.value),onKeyPress:c,placeholder:"ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...",className:"flex-1 resize-none border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-gray-100",rows:2,disabled:h,maxLength:1e3}),e.jsx("div",{className:"flex flex-col space-y-1",children:h?e.jsx(M,{onClick:$,variant:"outline",size:"sm",children:"ì·¨ì†Œ"}):e.jsx(M,{onClick:k,disabled:!i.trim(),size:"sm",children:"ì „ì†¡"})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Enterë¡œ ì „ì†¡, Shift+Enterë¡œ ì¤„ë°”ê¿ˆ"}),e.jsxs("p",{className:"text-xs text-gray-400",children:[i.length,"/1000"]})]})]})]})})}function Ce({activityId:x,className:y}){const[i,a]=u.useState([]),[n,t]=u.useState(null),{data:h}=T(),{data:g,isLoading:b}=ue(x);u.useEffect(()=>{h&&g&&d()},[h,g]);const d=async()=>{if(!(!h||!g))try{const{data:o,error:j}=await R.from("student_checklist_progress").select("checklist_item_id, is_completed, completed_at").eq("student_id",h.id);if(j)throw j;const k=new Map((o==null?void 0:o.map(c=>[c.checklist_item_id,c]))||[]),$=g.map(c=>{const C=k.get(c.id);return{...c,is_completed:(C==null?void 0:C.is_completed)||!1,completed_at:C==null?void 0:C.completed_at}});a($)}catch(o){console.error("Error loading checklist progress:",o)}},_=async o=>{if(!(!h||n)){t(o);try{const j=i.find(C=>C.id===o);if(!j)return;const k=!j.is_completed,$=new Date().toISOString(),{error:c}=await R.from("student_checklist_progress").upsert({student_id:h.id,checklist_item_id:o,is_completed:k,completed_at:k?$:null});if(c)throw c;a(C=>C.map(f=>f.id===o?{...f,is_completed:k,completed_at:k?$:void 0}:f))}catch(j){console.error("Error updating checklist progress:",j),alert("ì²´í¬ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{t(null)}}};if(b)return e.jsxs(p,{className:y,children:[e.jsx(D,{children:e.jsx(A,{children:"ì²´í¬ë¦¬ìŠ¤íŠ¸"})}),e.jsx(v,{children:e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(o=>e.jsx("div",{className:"h-16 bg-gray-200 rounded"},o))})})]});if(!g||g.length===0)return e.jsxs(p,{className:y,children:[e.jsx(D,{children:e.jsx(A,{children:"ì²´í¬ë¦¬ìŠ¤íŠ¸"})}),e.jsx(v,{children:e.jsx("p",{className:"text-gray-500 text-center py-8",children:"ì´ í™œë™ì—ëŠ” ì²´í¬ë¦¬ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤."})})]});const r=i.length,w=i.filter(o=>o.is_completed).length,z=r>0?w/r*100:0;return e.jsxs(p,{className:y,children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(A,{children:"ì²´í¬ë¦¬ìŠ¤íŠ¸"}),e.jsxs(B,{variant:z===100?"success":"info",children:[w,"/",r," ì™„ë£Œ"]})]})}),e.jsxs(v,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[e.jsx("span",{children:"ì§„í–‰ë¥ "}),e.jsxs("span",{children:[Math.round(z),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${z}%`}})})]}),e.jsx("div",{className:"space-y-3",children:i.sort((o,j)=>o.order_index-j.order_index).map(o=>{const j=n===o.id;return e.jsxs("div",{className:`flex items-start space-x-3 p-3 rounded-lg border transition-colors ${o.is_completed?"bg-green-50 border-green-200":"bg-white border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("button",{onClick:()=>_(o.id),disabled:j,className:`flex-shrink-0 w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${o.is_completed?"bg-green-500 border-green-500 text-white":"border-gray-300 hover:border-primary-500"} ${j?"opacity-50 cursor-not-allowed":""}`,children:j?e.jsx("div",{className:"w-3 h-3 border border-current border-t-transparent rounded-full animate-spin"}):o.is_completed?e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):null}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:`font-medium ${o.is_completed?"text-green-900 line-through":"text-gray-900"}`,children:o.title}),o.is_required&&e.jsx(B,{variant:"error",size:"sm",children:"í•„ìˆ˜"})]}),o.description&&e.jsx("p",{className:`text-sm mt-1 ${o.is_completed?"text-green-700":"text-gray-600"}`,children:o.description}),o.completed_at&&e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["ì™„ë£Œ: ",new Date(o.completed_at).toLocaleString()]})]})]},o.id)})}),z===100&&e.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 text-green-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-green-800 font-medium",children:"ëª¨ë“  ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ğŸ‰"})]})})]})]})}function _e({onFileProcessed:x,onFileUploaded:y,className:i,maxFiles:a=10,showPreview:n=!0}){const[t,h]=u.useState([]),[g,b]=u.useState(!1),[d,_]=u.useState(null),[r,w]=u.useState({}),z=u.useRef(null),{data:o}=T(),j=de(),k=oe(),$=u.useCallback(async s=>{if(!s||!o)return;const l=Array.from(s);if(t.length+l.length>a){alert(`ìµœëŒ€ ${a}ê°œì˜ íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);return}for(const N of l){const W=je(N);if(!W.isValid){alert(`${N.name}: ${W.error}`);continue}const I=`file-${Date.now()}-${Math.random()}`;w(H=>({...H,[I]:0}));try{let H=N,U;if(Y(N.type))try{U=await ge(N),H=await pe(N,500),w(E=>({...E,[I]:20}))}catch(E){console.warn("Image processing failed, using original file:",E)}w(E=>({...E,[I]:50}));const V=await j.mutateAsync({file:H,studentId:o.id});w(E=>({...E,[I]:80}));const X={id:I,name:N.name,size:N.size,type:N.type,url:V.url,uploadedAt:new Date().toISOString(),processed:!1,thumbnail:U,category:c(N.type)};if(h(E=>[...E,X]),y==null||y(X),Z(N.type))try{w(E=>({...E,[I]:90})),await k.mutateAsync({fileUrl:V.url,fileName:N.name}),h(E=>E.map(q=>q.id===I?{...q,processed:!0}:q)),x==null||x(N.name)}catch(E){console.error("PDF processing error:",E),alert(`${N.name} PDF ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`)}w(E=>({...E,[I]:100})),setTimeout(()=>{w(E=>{const q={...E};return delete q[I],q})},1e3)}catch(H){console.error("File upload error:",H),alert(`${N.name} ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`),w(U=>{const V={...U};return delete V[I],V})}}},[o,t.length,a,j,k,y,x]),c=s=>s.startsWith("image/")?"image":s.startsWith("audio/")?"audio":s.startsWith("video/")?"video":s.includes("pdf")||s.includes("document")||s.includes("text")?"document":"unknown",C=s=>{s.preventDefault(),b(!0)},f=s=>{s.preventDefault(),b(!1)},S=s=>{s.preventDefault(),b(!1),$(s.dataTransfer.files)},F=s=>{$(s.target.files),s.target.value=""},L=s=>{h(l=>l.filter(N=>N.id!==s)),w(l=>{const N={...l};return delete N[s],N})},P=s=>{G(s.type)&&_(s)},m=s=>{const l="w-8 h-8";switch(s.category){case"image":return s.thumbnail?e.jsx("img",{src:s.thumbnail,alt:s.name,className:"w-8 h-8 object-cover rounded"}):e.jsx("svg",{className:`${l} text-green-500`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})});case"document":return e.jsx("svg",{className:`${l} text-red-500`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})});case"audio":return e.jsx("svg",{className:`${l} text-purple-500`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM15.657 6.343a1 1 0 011.414 0A9.972 9.972 0 0119 12a9.972 9.972 0 01-1.929 5.657 1 1 0 11-1.414-1.414A7.971 7.971 0 0017 12a7.971 7.971 0 00-1.343-4.243 1 1 0 010-1.414z",clipRule:"evenodd"})});case"video":return e.jsx("svg",{className:`${l} text-blue-500`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zm12.553 1.106A1 1 0 0116 8v4a1 1 0 01-1.447.894l-2-1A1 1 0 0112 11V9a1 1 0 01.553-.894l2-1z",clipRule:"evenodd"})});default:return e.jsx("svg",{className:`${l} text-gray-500`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})})}};return e.jsxs(e.Fragment,{children:[e.jsxs(p,{className:i,children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(A,{children:"íŒŒì¼ ì—…ë¡œë“œ"}),e.jsxs(B,{variant:"info",size:"sm",children:[t.length,"/",a]})]})}),e.jsxs(v,{children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${g?"border-primary-500 bg-primary-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:C,onDragLeave:f,onDrop:S,children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:e.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì—¬ ë†“ê±°ë‚˜"," ",e.jsx("button",{type:"button",className:"font-medium text-primary-600 hover:text-primary-500",onClick:()=>{var s;return(s=z.current)==null?void 0:s.click()},disabled:t.length>=a,children:"í´ë¦­í•˜ì—¬ ì„ íƒ"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ì´ë¯¸ì§€, PDF, ë¬¸ì„œ, ì˜¤ë””ì˜¤, ë¹„ë””ì˜¤ íŒŒì¼ ì§€ì›"})]}),e.jsx("input",{ref:z,type:"file",className:"hidden",multiple:!0,accept:"image/*,.pdf,.txt,.doc,.docx,.xls,.xlsx,.ppt,.pptx,audio/*,video/*",onChange:F,disabled:t.length>=a})]}),Object.keys(r).length>0&&e.jsx("div",{className:"mt-4 space-y-2",children:Object.entries(r).map(([s,l])=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[e.jsx("span",{children:"ì—…ë¡œë“œ ì¤‘..."}),e.jsxs("span",{children:[l,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${l}%`}})})]},s))}),t.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"ì—…ë¡œë“œëœ íŒŒì¼"}),e.jsx("div",{className:"space-y-3",children:t.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`cursor-pointer ${G(s.type)?"hover:opacity-80":""}`,onClick:()=>G(s.type)&&P(s),children:m(s)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate max-w-xs",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[e.jsx("span",{children:fe(s.size)}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:new Date(s.uploadedAt).toLocaleString()})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.type==="application/pdf"&&e.jsx(B,{variant:s.processed?"success":"warning",size:"sm",children:s.processed?"ì²˜ë¦¬ ì™„ë£Œ":"ì²˜ë¦¬ ì¤‘"}),G(s.type)&&n&&e.jsx(M,{variant:"outline",size:"sm",onClick:()=>P(s),children:"ë¯¸ë¦¬ë³´ê¸°"}),e.jsx(M,{variant:"outline",size:"sm",onClick:()=>L(s.id),children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},s.id))})]}),(j.isPending||k.isPending)&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),e.jsx("span",{className:"text-sm text-blue-800",children:j.isPending?"íŒŒì¼ ì—…ë¡œë“œ ì¤‘...":"PDF ì²˜ë¦¬ ì¤‘..."})]})}),e.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-yellow-800 mb-2",children:"ğŸ’¡ íŒŒì¼ ì—…ë¡œë“œ ê°€ì´ë“œ"}),e.jsxs("ul",{className:"text-xs text-yellow-700 space-y-1",children:[e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ì´ë¯¸ì§€:"})," ìë™ìœ¼ë¡œ ì••ì¶•ë˜ì–´ ì—…ë¡œë“œë©ë‹ˆë‹¤ (ìµœëŒ€ 5MB)"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"PDF:"})," ìë™ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ AIê°€ ë‚´ìš©ì„ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ìµœëŒ€ 10MB)"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ë¬¸ì„œ:"})," Word, Excel, PowerPoint íŒŒì¼ ì§€ì› (ìµœëŒ€ 10MB)"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ë¯¸ë””ì–´:"})," ì˜¤ë””ì˜¤(ìµœëŒ€ 20MB), ë¹„ë””ì˜¤(ìµœëŒ€ 50MB) íŒŒì¼ ì§€ì›"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ë¯¸ë¦¬ë³´ê¸°:"})," ì´ë¯¸ì§€ì™€ PDF íŒŒì¼ì€ ë¯¸ë¦¬ë³´ê¸°ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤"]})]})]})]})]}),d&&e.jsx(ve,{isOpen:!0,onClose:()=>_(null),title:d.name,size:"xl",children:e.jsx("div",{className:"max-h-96 overflow-auto",children:Y(d.type)?e.jsx("img",{src:d.url,alt:d.name,className:"max-w-full h-auto mx-auto"}):Z(d.type)?e.jsx("iframe",{src:d.url,className:"w-full h-96",title:d.name}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500",children:"ë¯¸ë¦¬ë³´ê¸°ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤."}),e.jsx(M,{className:"mt-4",onClick:()=>window.open(d.url,"_blank"),children:"íŒŒì¼ ë‹¤ìš´ë¡œë“œ"})]})})})]})}function Se({activityId:x,className:y}){const[i,a]=u.useState({title:"",content:"",is_submitted:!1}),[n,t]=u.useState({title:"",content:""}),[h,g]=u.useState(!0),[b,d]=u.useState(!1),[_,r]=u.useState(!1),[w,z]=u.useState(!0),[o,j]=u.useState(null),{data:k}=T();u.useEffect(()=>{k&&x&&($(),c())},[k,x]),u.useEffect(()=>{if(!w||i.is_submitted)return;const m=setInterval(()=>{(n.title.trim()||n.content.trim())&&C()},3e4);return()=>clearInterval(m)},[n,w,i.is_submitted]);const $=async()=>{try{const{data:m,error:s}=await R.from("argumentation_responses").select("*").eq("student_id",k.id).eq("activity_id",x).single();if(s&&s.code!=="PGRST116")throw s;m&&(a(m),t({title:m.title||"",content:m.content||""}))}catch(m){console.error("Error loading argumentation data:",m)}finally{g(!1)}},c=async()=>{try{const{data:m,error:s}=await R.from("student_work_drafts").select("content, updated_at").eq("student_id",k.id).eq("activity_id",x).eq("draft_type","argumentation").single();if(s&&s.code!=="PGRST116")throw s;if(m&&m.content)try{const l=JSON.parse(m.content);(l.title||l.content)&&(t({title:l.title||"",content:l.content||"",last_saved:m.updated_at}),j(m.updated_at))}catch(l){console.error("Error parsing draft content:",l)}}catch(m){console.error("Error loading draft data:",m)}},C=async()=>{if(!(!k||b)){d(!0);try{const m=JSON.stringify({title:n.title,content:n.content}),{error:s}=await R.from("student_work_drafts").upsert({student_id:k.id,activity_id:x,draft_type:"argumentation",content:m});if(s)throw s;const l=new Date().toISOString();j(l),t(N=>({...N,last_saved:l}))}catch(m){console.error("Error saving draft:",m)}finally{d(!1)}}},f=async()=>{if(!k||!n.title.trim()||!n.content.trim()){alert("ì œëª©ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if(window.confirm("ë…¼ì¦ë¬¸ì„ ì œì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì œì¶œ í›„ì—ëŠ” ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")){r(!0);try{const m={student_id:k.id,activity_id:x,title:n.title,content:n.content,is_submitted:!0,submitted_at:new Date().toISOString()};if(i.id){const{error:s}=await R.from("argumentation_responses").update(m).eq("id",i.id);if(s)throw s}else{const{data:s,error:l}=await R.from("argumentation_responses").insert(m).select().single();if(l)throw l;a(s)}await R.from("student_work_drafts").delete().eq("student_id",k.id).eq("activity_id",x).eq("draft_type","argumentation"),alert("ë…¼ì¦ë¬¸ì´ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!"),await $()}catch(m){console.error("Error submitting argumentation:",m),alert("ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}finally{r(!1)}}},S=m=>{const s=m.target.value;t(l=>({...l,title:s}))},F=m=>{const s=m.target.value;t(l=>({...l,content:s}))},L=m=>m.trim().split(/\s+/).filter(s=>s.length>0).length,P=m=>m.length;return h?e.jsx(p,{className:y,children:e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"ë…¼ì¦ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]})})}):e.jsxs(p,{className:y,children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(A,{children:"ë…¼ì¦ë¬¸ ì‘ì„±"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[i.is_submitted?e.jsx(B,{variant:"success",children:"ì œì¶œ ì™„ë£Œ"}):e.jsx(B,{variant:"warning",children:"ì‘ì„± ì¤‘"}),o&&e.jsxs("span",{className:"text-xs text-gray-500",children:["ë§ˆì§€ë§‰ ì €ì¥: ",new Date(o).toLocaleString()]})]})]})}),e.jsx(v,{children:i.is_submitted?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:i.title}),e.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:["ì œì¶œì¼: ",i.submitted_at?new Date(i.submitted_at).toLocaleString():"ì•Œ ìˆ˜ ì—†ìŒ"]})]}),e.jsx("div",{className:"prose max-w-none",children:e.jsx("div",{className:"whitespace-pre-wrap text-gray-800 leading-relaxed",children:i.content})}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["ê¸€ì ìˆ˜: ",P(i.content)," | ë‹¨ì–´ ìˆ˜: ",L(i.content)]}),e.jsx(B,{variant:"success",children:"ì œì¶œ ì™„ë£Œ"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(K,{label:"ë…¼ì¦ë¬¸ ì œëª©",value:n.title,onChange:S,placeholder:"ë…¼ì¦ë¬¸ì˜ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”",disabled:_,maxLength:100}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ë…¼ì¦ ë‚´ìš©"}),e.jsx("textarea",{value:n.content,onChange:F,rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-gray-100",placeholder:`ë…¼ì¦ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”...

ë‹¤ìŒ êµ¬ì¡°ë¥¼ ì°¸ê³ í•˜ì„¸ìš”:
1. ì£¼ì¥ (Claim): ë‹¹ì‹ ì˜ ì…ì¥ì„ ëª…í™•íˆ ì œì‹œ
2. ê·¼ê±° (Evidence): ì£¼ì¥ì„ ë’·ë°›ì¹¨í•˜ëŠ” ì‚¬ì‹¤, ë°ì´í„°, ì˜ˆì‹œ
3. ë…¼ì¦ (Warrant): ê·¼ê±°ê°€ ì£¼ì¥ì„ ì–´ë–»ê²Œ ì§€ì§€í•˜ëŠ”ì§€ ì„¤ëª…
4. ë°˜ë°• ê³ ë ¤ (Counterargument): ë°˜ëŒ€ ì˜ê²¬ì„ ì¸ì •í•˜ê³  ëŒ€ì‘
5. ê²°ë¡  (Conclusion): ì£¼ì¥ì„ ì¬í™•ì¸í•˜ê³  ìš”ì•½`,disabled:_,maxLength:5e3}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["ê¸€ì ìˆ˜: ",P(n.content),"/5000 | ë‹¨ì–´ ìˆ˜: ",L(n.content)]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("label",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:w,onChange:m=>z(m.target.checked),className:"mr-1 h-3 w-3 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),"ìë™ ì €ì¥"]})})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[e.jsx(M,{variant:"outline",onClick:C,disabled:b||_,loading:b,children:"ì„ì‹œì €ì¥"}),e.jsx(M,{onClick:f,disabled:!n.title.trim()||!n.content.trim()||_,loading:_,children:"ì œì¶œí•˜ê¸°"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"ğŸ’¡ ë…¼ì¦ë¬¸ ì‘ì„± ê°€ì´ë“œ"}),e.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ëª…í™•í•œ ì£¼ì¥:"})," ë‹¹ì‹ ì˜ ì…ì¥ì„ í•œ ë¬¸ì¥ìœ¼ë¡œ ëª…í™•íˆ í‘œí˜„í•˜ì„¸ìš”"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ê·¼ê±°:"})," ì‚¬ì‹¤, í†µê³„, ì „ë¬¸ê°€ ì˜ê²¬ ë“±ì„ í™œìš©í•˜ì„¸ìš”"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ë…¼ë¦¬ì  ì—°ê²°:"})," ê·¼ê±°ê°€ ì£¼ì¥ì„ ì–´ë–»ê²Œ ì§€ì§€í•˜ëŠ”ì§€ ì„¤ëª…í•˜ì„¸ìš”"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ë°˜ë°• ê³ ë ¤:"})," ë°˜ëŒ€ ì˜ê²¬ì„ ì¸ì •í•˜ê³  í•©ë¦¬ì ìœ¼ë¡œ ëŒ€ì‘í•˜ì„¸ìš”"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ëª…í™•í•œ ê²°ë¡ :"})," ì£¼ì¥ì„ ì¬í™•ì¸í•˜ê³  í•µì‹¬ ë‚´ìš©ì„ ìš”ì•½í•˜ì„¸ìš”"]})]})]})]})})]})}const J=[{id:"clarity",name:"ëª…í™•ì„±",description:"ì£¼ì¥ì´ ëª…í™•í•˜ê³  ì´í•´í•˜ê¸° ì‰¬ìš´ê°€?",maxScore:5},{id:"evidence",name:"ê·¼ê±°ì˜ ì ì ˆì„±",description:"ì£¼ì¥ì„ ë’·ë°›ì¹¨í•˜ëŠ” ê·¼ê±°ê°€ ì ì ˆí•˜ê³  ì¶©ë¶„í•œê°€?",maxScore:5},{id:"logic",name:"ë…¼ë¦¬ì„±",description:"ë…¼ë¦¬ì  íë¦„ì´ ì¼ê´€ë˜ê³  íƒ€ë‹¹í•œê°€?",maxScore:5},{id:"counterargument",name:"ë°˜ë°• ê³ ë ¤",description:"ë°˜ëŒ€ ì˜ê²¬ì„ ì ì ˆíˆ ê³ ë ¤í•˜ê³  ëŒ€ì‘í–ˆëŠ”ê°€?",maxScore:5},{id:"overall",name:"ì „ì²´ì  ì™„ì„±ë„",description:"ë…¼ì¦ë¬¸ì˜ ì „ì²´ì ì¸ ì™„ì„±ë„ëŠ” ì–´ë–¤ê°€?",maxScore:5}];function Me({activityId:x,className:y}){const[i,a]=u.useState([]),[n,t]=u.useState(null),[h,g]=u.useState({}),[b,d]=u.useState({}),[_,r]=u.useState(""),[w,z]=u.useState(!0),[o,j]=u.useState(!1),{data:k}=T();u.useEffect(()=>{k&&x&&$()},[k,x]);const $=async()=>{try{const{data:s,error:l}=await R.from("peer_evaluations").select(`
          *,
          target:students!peer_evaluations_target_id_fkey(name),
          target_response:argumentation_responses!peer_evaluations_target_id_fkey(title, content)
        `).eq("evaluator_id",k.id).eq("activity_id",x);if(l)throw l;const N=s.map(I=>{var H,U,V;return{id:I.id,evaluator_id:I.evaluator_id,target_id:I.target_id,target_name:((H=I.target)==null?void 0:H.name)||"ì•Œ ìˆ˜ ì—†ìŒ",target_title:((U=I.target_response)==null?void 0:U.title)||"ì œëª© ì—†ìŒ",target_content:((V=I.target_response)==null?void 0:V.content)||"ë‚´ìš© ì—†ìŒ",evaluation_data:I.evaluation_data,is_completed:I.is_completed,completed_at:I.completed_at}});a(N);const W=N.find(I=>!I.is_completed);W&&(t(W),c(W))}catch(s){console.error("Error loading evaluation targets:",s)}finally{z(!1)}},c=s=>{s.evaluation_data?(g(s.evaluation_data.scores||{}),d(s.evaluation_data.comments||{}),r(s.evaluation_data.overallComment||"")):(g({}),d({}),r(""))},C=s=>{t(s),c(s)},f=(s,l)=>{g(N=>({...N,[s]:l}))},S=(s,l)=>{d(N=>({...N,[s]:l}))},F=async()=>{if(!n||!k)return;const s=J.filter(l=>!h[l.id]);if(s.length>0){alert(`ë‹¤ìŒ í•­ëª©ì˜ ì ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”: ${s.map(l=>l.name).join(", ")}`);return}if(!_.trim()){alert("ì „ì²´ì ì¸ í”¼ë“œë°±ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if(window.confirm("í‰ê°€ë¥¼ ì œì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì œì¶œ í›„ì—ëŠ” ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")){j(!0);try{const l={scores:h,comments:b,overallComment:_,submittedAt:new Date().toISOString()},{error:N}=await R.from("peer_evaluations").update({evaluation_data:l,is_completed:!0,completed_at:new Date().toISOString()}).eq("id",n.id);if(N)throw N;alert("í‰ê°€ê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!"),await $();const W=i.find(I=>I.id!==n.id&&!I.is_completed);W?(t(W),c(W)):t(null)}catch(l){console.error("Error submitting evaluation:",l),alert("í‰ê°€ ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}finally{j(!1)}}},L=()=>Object.values(h).reduce((s,l)=>s+l,0),P=()=>J.reduce((s,l)=>s+l.maxScore,0),m=()=>i.filter(s=>s.is_completed).length;return w?e.jsx(p,{className:y,children:e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"ë™ë£Œí‰ê°€ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]})})}):i.length===0?e.jsxs(p,{className:y,children:[e.jsx(D,{children:e.jsx(A,{children:"ë™ë£Œí‰ê°€"})}),e.jsx(v,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"mb-4",children:e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("p",{className:"text-gray-500",children:"ì•„ì§ ë°°ì •ëœ ë™ë£Œí‰ê°€ê°€ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"ë…¼ì¦ë¬¸ ì œì¶œ í›„ ê´€ë¦¬ìê°€ ë™ë£Œí‰ê°€ë¥¼ ë°°ì •í•˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."})]})})]}):e.jsxs(p,{className:y,children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(A,{children:"ë™ë£Œí‰ê°€"}),e.jsxs(B,{variant:"info",children:[m(),"/",i.length," ì™„ë£Œ"]})]})}),e.jsxs(v,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"í‰ê°€ ëŒ€ìƒ"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:i.map(s=>e.jsxs("button",{onClick:()=>C(s),className:`p-3 border rounded-lg text-left transition-colors ${(n==null?void 0:n.id)===s.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,disabled:s.is_completed,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.target_name}),e.jsx(B,{variant:s.is_completed?"success":"warning",size:"sm",children:s.is_completed?"ì™„ë£Œ":"ëŒ€ê¸°"})]}),e.jsx("p",{className:"text-sm text-gray-600 truncate",children:s.target_title})]},s.id))})]}),n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:[n.target_name,"ì˜ ë…¼ì¦ë¬¸"]}),e.jsx("h5",{className:"text-lg font-semibold text-gray-800 mb-3",children:n.target_title}),e.jsx("div",{className:"prose max-w-none",children:e.jsx("div",{className:"whitespace-pre-wrap text-gray-700 text-sm leading-relaxed max-h-64 overflow-y-auto",children:n.target_content})})]}),n.is_completed?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"ì œì¶œëœ í‰ê°€"}),e.jsx(B,{variant:"success",children:"í‰ê°€ ì™„ë£Œ"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:J.map(s=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("span",{className:"text-lg font-bold text-primary-600",children:[h[s.id]||0,"/",s.maxScore]})]}),b[s.id]&&e.jsx("p",{className:"text-sm text-gray-600",children:b[s.id]})]},s.id))}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"ì „ì²´ í”¼ë“œë°±"}),e.jsx("p",{className:"text-blue-800",children:_})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["ì´ì : ",L(),"/",P()]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ì™„ë£Œì¼: ",n.completed_at?new Date(n.completed_at).toLocaleString():"ì•Œ ìˆ˜ ì—†ìŒ"]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"í‰ê°€ ì‘ì„±"}),e.jsx("div",{className:"space-y-4",children:J.map(s=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-primary-600",children:[h[s.id]||0,"/",s.maxScore]})})]}),e.jsx("div",{className:"flex space-x-2 mb-3",children:Array.from({length:s.maxScore},(l,N)=>N+1).map(l=>e.jsx("button",{onClick:()=>f(s.id,l),className:`w-8 h-8 rounded-full border-2 text-sm font-medium transition-colors ${h[s.id]===l?"border-primary-500 bg-primary-500 text-white":"border-gray-300 text-gray-600 hover:border-primary-300"}`,children:l},l))}),e.jsx("textarea",{value:b[s.id]||"",onChange:l=>S(s.id,l.target.value),placeholder:"ì´ í•­ëª©ì— ëŒ€í•œ êµ¬ì²´ì ì¸ í”¼ë“œë°±ì„ ì‘ì„±í•´ì£¼ì„¸ìš” (ì„ íƒì‚¬í•­)",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]},s.id))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ì „ì²´ì ì¸ í”¼ë“œë°± *"}),e.jsx("textarea",{value:_,onChange:s=>r(s.target.value),placeholder:"ë…¼ì¦ë¬¸ì— ëŒ€í•œ ì „ì²´ì ì¸ í”¼ë“œë°±ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. ì¢‹ì€ ì ê³¼ ê°œì„ í•  ì ì„ ê· í˜•ìˆê²Œ ì œì‹œí•´ì£¼ì„¸ìš”.",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center",children:e.jsxs("div",{className:"text-xl font-bold text-gray-900",children:["í˜„ì¬ ì´ì : ",L(),"/",P()]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(M,{onClick:F,disabled:L()===0||!_.trim()||o,loading:o,children:"í‰ê°€ ì œì¶œ"})})]})]}),e.jsxs("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h5",{className:"text-sm font-medium text-yellow-800 mb-2",children:"ğŸ’¡ ë™ë£Œí‰ê°€ ê°€ì´ë“œ"}),e.jsxs("ul",{className:"text-xs text-yellow-700 space-y-1",children:[e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ê³µì •í•˜ê³  ê°ê´€ì ìœ¼ë¡œ:"})," ê°œì¸ì  ê°ì •ì´ ì•„ë‹Œ ë…¼ì¦ì˜ ì§ˆì„ í‰ê°€í•˜ì„¸ìš”"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ê±´ì„¤ì ì¸ í”¼ë“œë°±:"})," ë¹„íŒë³´ë‹¤ëŠ” ê°œì„  ë°©í–¥ì„ ì œì‹œí•˜ì„¸ìš”"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"êµ¬ì²´ì ì¸ ê·¼ê±°:"})," ì ìˆ˜ì— ëŒ€í•œ êµ¬ì²´ì ì¸ ì´ìœ ë¥¼ ì„¤ëª…í•˜ì„¸ìš”"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ê· í˜•ì¡íŒ í‰ê°€:"})," ì¢‹ì€ ì ê³¼ ê°œì„ í•  ì ì„ ëª¨ë‘ ì–¸ê¸‰í•˜ì„¸ìš”"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"ì¡´ì¤‘í•˜ëŠ” íƒœë„:"})," ìƒëŒ€ë°©ì„ ì¡´ì¤‘í•˜ëŠ” ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”"]})]})]})]})]})}function Te(){const{activityId:x}=he(),y=le(),{user:i}=xe();ye({studentId:i==null?void 0:i.id,activityId:x});const{data:a,isLoading:n,error:t}=be(x||""),h=d=>{switch(d){case"argumentation":return"ë…¼ì¦ í™œë™";case"discussion":return"í† ë¡  í™œë™";case"experiment":return"ì‹¤í—˜ í™œë™";default:return d}},g=d=>{switch(d){case"argumentation":return"info";case"discussion":return"warning";case"experiment":return"success";default:return"default"}};if(n)return e.jsx(O,{title:"í™œë™ ë¡œë”© ì¤‘...",showSidebar:!1,children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})})});if(t||!a)return e.jsx(O,{title:"í™œë™ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",showSidebar:!1,children:e.jsx(p,{children:e.jsx(v,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"ìš”ì²­í•˜ì‹  í™œë™ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}),e.jsx(M,{onClick:()=>y("/student"),children:"ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°"})]})})})});const b=e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(M,{variant:"outline",onClick:()=>y("/student"),children:"ëŒ€ì‹œë³´ë“œë¡œ"}),e.jsx(M,{children:"í™œë™ ì™„ë£Œ"})]});return e.jsxs(O,{title:a.title,subtitle:h(a.type),headerActions:b,showSidebar:!1,children:[e.jsxs(p,{className:"mb-6",children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(A,{children:"í™œë™ ì •ë³´"}),e.jsx(B,{variant:g(a.type),children:h(a.type)})]})}),e.jsx(v,{children:e.jsx("p",{className:"text-gray-700 leading-relaxed",children:a.description})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(Ce,{activityId:a.id}),e.jsx("div",{className:"mt-6",children:e.jsx(_e,{onFileProcessed:d=>{console.log("File processed:",d)},maxFiles:5,showPreview:!0})})]}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs(p,{children:[e.jsx(D,{children:e.jsx(A,{children:"AI í•™ìŠµ ë„ìš°ë¯¸"})}),e.jsx(v,{children:e.jsx("div",{className:"p-0",children:e.jsx(me,{activityId:a.id})})})]})})]}),a.type==="argumentation"&&e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsx(Se,{activityId:a.id}),e.jsx(Me,{activityId:a.id})]}),a.type==="discussion"&&e.jsxs(p,{className:"mt-6",children:[e.jsx(D,{children:e.jsx(A,{children:"í† ë¡  ì°¸ì—¬"})}),e.jsx(v,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"í† ë¡  ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤."}),e.jsx("p",{className:"text-sm text-gray-400",children:"ê³§ ì‹¤ì‹œê°„ í† ë¡  ê¸°ëŠ¥ì„ ì œê³µí•  ì˜ˆì •ì…ë‹ˆë‹¤."})]})})]}),a.type==="experiment"&&e.jsxs(p,{className:"mt-6",children:[e.jsx(D,{children:e.jsx(A,{children:"ì‹¤í—˜ ê¸°ë¡"})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ì‹¤í—˜ ê°€ì„¤"}),e.jsx("textarea",{rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"ì‹¤í—˜ ê°€ì„¤ì„ ì‘ì„±í•˜ì„¸ìš”..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ì‹¤í—˜ ê³¼ì • ë° ê´€ì°° ë‚´ìš©"}),e.jsx("textarea",{rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"ì‹¤í—˜ ê³¼ì •ê³¼ ê´€ì°°í•œ ë‚´ìš©ì„ ìì„¸íˆ ê¸°ë¡í•˜ì„¸ìš”..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ì‹¤í—˜ ê²°ê³¼ ë° ê²°ë¡ "}),e.jsx("textarea",{rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"ì‹¤í—˜ ê²°ê³¼ì™€ ê²°ë¡ ì„ ì‘ì„±í•˜ì„¸ìš”..."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(M,{variant:"outline",children:"ì„ì‹œì €ì¥"}),e.jsx(M,{children:"ì‹¤í—˜ ë³´ê³ ì„œ ì œì¶œ"})]})]})})]})]})}function Le({onFileProcessed:x,className:y}){const[i,a]=u.useState([]),[n,t]=u.useState(!1),h=u.useRef(null),{data:g}=T(),b=de(),d=oe(),_=c=>{!c||!g||Array.from(c).forEach(async C=>{if(C.size>10*1024*1024){alert(`${C.name}ì€(ëŠ”) íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤. (ìµœëŒ€ 10MB)`);return}if(!["application/pdf","text/plain","image/jpeg","image/png","image/gif","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(C.type)){alert(`${C.name}ì€(ëŠ”) ì§€ì›ë˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤.`);return}try{const S=await b.mutateAsync({file:C,studentId:g.id}),F={id:`file-${Date.now()}-${Math.random()}`,name:S.fileName,size:S.fileSize,type:S.fileType,url:S.url,uploadedAt:new Date().toISOString(),processed:!1};if(a(L=>[...L,F]),C.type==="application/pdf")try{await d.mutateAsync({fileUrl:S.url,fileName:S.fileName}),a(L=>L.map(P=>P.id===F.id?{...P,processed:!0}:P)),x==null||x(S.fileName)}catch(L){console.error("PDF processing error:",L),alert("PDF ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}catch(S){console.error("File upload error:",S),alert("íŒŒì¼ ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}})},r=c=>{c.preventDefault(),t(!0)},w=c=>{c.preventDefault(),t(!1)},z=c=>{c.preventDefault(),t(!1),_(c.dataTransfer.files)},o=c=>{_(c.target.files),c.target.value=""},j=c=>{if(c===0)return"0 Bytes";const C=1024,f=["Bytes","KB","MB","GB"],S=Math.floor(Math.log(c)/Math.log(C));return parseFloat((c/Math.pow(C,S)).toFixed(2))+" "+f[S]},k=c=>c.includes("pdf")?e.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}):c.includes("image")?e.jsx("svg",{className:"w-8 h-8 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}):e.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})}),$=c=>{a(C=>C.filter(f=>f.id!==c))};return e.jsxs(p,{className:y,children:[e.jsx(D,{children:e.jsx(A,{children:"íŒŒì¼ ì—…ë¡œë“œ"})}),e.jsxs(v,{children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${n?"border-primary-500 bg-primary-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:r,onDragLeave:w,onDrop:z,children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:e.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì—¬ ë†“ê±°ë‚˜"," ",e.jsx("button",{type:"button",className:"font-medium text-primary-600 hover:text-primary-500",onClick:()=>{var c;return(c=h.current)==null?void 0:c.click()},children:"í´ë¦­í•˜ì—¬ ì„ íƒ"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PDF, ì´ë¯¸ì§€, í…ìŠ¤íŠ¸ íŒŒì¼ ì§€ì› (ìµœëŒ€ 10MB)"})]}),e.jsx("input",{ref:h,type:"file",className:"hidden",multiple:!0,accept:".pdf,.txt,.jpg,.jpeg,.png,.gif,.doc,.docx",onChange:o})]}),i.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"ì—…ë¡œë“œëœ íŒŒì¼"}),e.jsx("div",{className:"space-y-3",children:i.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[k(c.type),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:c.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[j(c.size)," â€¢ ",new Date(c.uploadedAt).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c.type==="application/pdf"&&e.jsx(B,{variant:c.processed?"success":"warning",size:"sm",children:c.processed?"ì²˜ë¦¬ ì™„ë£Œ":"ì²˜ë¦¬ ì¤‘"}),e.jsx(M,{variant:"outline",size:"sm",onClick:()=>$(c.id),children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},c.id))})]}),(b.isPending||d.isPending)&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),e.jsx("span",{className:"text-sm text-blue-800",children:b.isPending?"íŒŒì¼ ì—…ë¡œë“œ ì¤‘...":"PDF ì²˜ë¦¬ ì¤‘..."})]})}),e.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-yellow-800 mb-2",children:"ğŸ’¡ íŒŒì¼ ì—…ë¡œë“œ íŒ"}),e.jsxs("ul",{className:"text-xs text-yellow-700 space-y-1",children:[e.jsx("li",{children:"â€¢ PDF íŒŒì¼ì€ ìë™ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ AIê°€ ë‚´ìš©ì„ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"}),e.jsx("li",{children:"â€¢ ì´ë¯¸ì§€ íŒŒì¼ì€ ì‹œê°ì  ì°¸ê³  ìë£Œë¡œ í™œìš©ë©ë‹ˆë‹¤"}),e.jsx("li",{children:"â€¢ í…ìŠ¤íŠ¸ íŒŒì¼ì€ ì¶”ê°€ í•™ìŠµ ìë£Œë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤"}),e.jsx("li",{children:'â€¢ ì²˜ë¦¬ëœ íŒŒì¼ì€ ì±„íŒ…ì—ì„œ "ë¬¸ì„œ ê²€ìƒ‰" ì˜µì…˜ì„ ì¼œë©´ í™œìš©ë©ë‹ˆë‹¤'})]})]})]})]})}const Ie=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),De=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253z"})}),Ae=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),ze=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})});function Ve(){const[x,y]=u.useState(null),[i,a]=u.useState(!1),{data:n}=ce(),t=[{label:"ëŒ€ì‹œë³´ë“œ",href:"/student",icon:e.jsx(De,{})},{label:"AI ì±„íŒ…",href:"/student/chat",icon:e.jsx(Ie,{})},{label:"ë‚´ í”„ë¡œí•„",href:"/student/profile",icon:e.jsx(Ae,{})},{label:"í™œë™ ê¸°ë¡",href:"/student/history",icon:e.jsx(ze,{})}],h=n==null?void 0:n.find(d=>d.id===x),g=d=>{switch(d){case"argumentation":return"ë…¼ì¦ í™œë™";case"discussion":return"í† ë¡  í™œë™";case"experiment":return"ì‹¤í—˜ í™œë™";default:return d}},b=e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(M,{variant:"outline",size:"sm",onClick:()=>a(!i),children:i?"íŒŒì¼ ì—…ë¡œë“œ ìˆ¨ê¸°ê¸°":"íŒŒì¼ ì—…ë¡œë“œ"}),e.jsx(M,{variant:"outline",size:"sm",onClick:()=>y(null),disabled:!x,children:"ì¼ë°˜ ì±„íŒ…"})]});return e.jsxs(O,{title:"AI ì±„íŒ…",subtitle:h?`${h.title} - ${g(h.type)}`:"ì¼ë°˜ í•™ìŠµ ì±„íŒ…",headerActions:b,sidebarItems:t,showSidebar:!0,children:[n&&n.length>0&&e.jsxs(p,{className:"mb-6",children:[e.jsx(D,{children:e.jsx(A,{children:"í™œë™ ì„ íƒ"})}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(M,{variant:x===null?"primary":"outline",size:"sm",onClick:()=>y(null),children:"ì¼ë°˜ ì±„íŒ…"}),n.map(d=>e.jsx(M,{variant:x===d.id?"primary":"outline",size:"sm",onClick:()=>y(d.id),children:d.title},d.id))]}),h&&e.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:h.title}),"ì— ëŒ€í•œ ë§ì¶¤í˜• AI ë„ì›€ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:h.description})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[i&&e.jsx("div",{className:"lg:col-span-1",children:e.jsx(Le,{onFileProcessed:d=>{console.log("File processed:",d)}})}),e.jsx("div",{className:i?"lg:col-span-3":"lg:col-span-4",children:e.jsxs(p,{children:[e.jsx(D,{children:e.jsx(A,{children:h?`${h.title} AI ë„ìš°ë¯¸`:"AI í•™ìŠµ ë„ìš°ë¯¸"})}),e.jsx(v,{padding:"none",children:e.jsx("div",{className:"h-[600px]",children:e.jsx(me,{activityId:x||void 0,className:"h-full"})})})]})})]}),e.jsxs(p,{className:"mt-6",children:[e.jsx(D,{children:e.jsx(A,{children:"ğŸ’¡ íš¨ê³¼ì ì¸ AI ì±„íŒ… ê°€ì´ë“œ"})}),e.jsx(v,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"ì¢‹ì€ ì§ˆë¬¸ ì˜ˆì‹œ"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:'â€¢ "ê¸°í›„ë³€í™”ì˜ ì£¼ìš” ì›ì¸ 3ê°€ì§€ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”"'}),e.jsx("li",{children:'â€¢ "ì´ ì‹¤í—˜ì—ì„œ ë³€ì¸ì„ ì–´ë–»ê²Œ í†µì œí•´ì•¼ í• ê¹Œìš”?"'}),e.jsx("li",{children:'â€¢ "ë…¼ì¦ì—ì„œ ë°˜ë°• ì˜ê²¬ì„ ì–´ë–»ê²Œ ë‹¤ë¤„ì•¼ í•˜ë‚˜ìš”?"'}),e.jsx("li",{children:'â€¢ "í† ë¡ ì—ì„œ ìƒëŒ€ë°© ì˜ê²¬ì„ ì¡´ì¤‘í•˜ëŠ” ë°©ë²•ì€?"'})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"ìœ ìš©í•œ ê¸°ëŠ¥"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"â€¢ ë¬¸ì„œ ê²€ìƒ‰: ì—…ë¡œë“œí•œ íŒŒì¼ ë‚´ìš©ì„ ì°¸ì¡°í•œ ë‹µë³€"}),e.jsx("li",{children:"â€¢ í™œë™ë³„ ë§ì¶¤ ë„ì›€: ê° í™œë™ì— íŠ¹í™”ëœ AI ì§€ì›"}),e.jsx("li",{children:"â€¢ ëŒ€í™” ê¸°ë¡: ì´ì „ ëŒ€í™” ë‚´ìš©ì„ ê¸°ì–µí•˜ëŠ” ì—°ì† ëŒ€í™”"}),e.jsx("li",{children:"â€¢ íŒŒì¼ ì—…ë¡œë“œ: PDF, ì´ë¯¸ì§€ ë“± ì°¸ê³  ìë£Œ í™œìš©"})]})]})]})})]})]})}const te=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Be=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253z"})}),$e=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),Ee=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})});function Oe(){const[x,y]=u.useState(!1),[i,a]=u.useState({name:"",class_name:""}),{user:n}=xe(),{data:t,isLoading:h}=T(),{data:g}=Q((t==null?void 0:t.id)||""),b=Ne(),d=[{label:"ëŒ€ì‹œë³´ë“œ",href:"/student",icon:e.jsx(Be,{})},{label:"AI ì±„íŒ…",href:"/student/chat",icon:e.jsx($e,{})},{label:"ë‚´ í”„ë¡œí•„",href:"/student/profile",icon:e.jsx(te,{})},{label:"í™œë™ ê¸°ë¡",href:"/student/history",icon:e.jsx(Ee,{})}];React.useEffect(()=>{t&&a({name:t.name||"",class_name:t.class_name||""})},[t]);const _=()=>{y(!0)},r=()=>{y(!1),t&&a({name:t.name||"",class_name:t.class_name||""})},w=async()=>{if(t)try{await b.mutateAsync({id:t.id,...i}),y(!1),alert("í”„ë¡œí•„ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤!")}catch(j){console.error("Error updating profile:",j),alert("í”„ë¡œí•„ ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},o=(()=>{if(!g)return{total:0,thisWeek:0,thisMonth:0};const j=new Date,k=new Date(j.getTime()-10080*60*1e3),$=new Date(j.getTime()-720*60*60*1e3);return{total:g.length,thisWeek:g.filter(c=>new Date(c.created_at)>=k).length,thisMonth:g.filter(c=>new Date(c.created_at)>=$).length}})();return h?e.jsx(O,{title:"ë‚´ í”„ë¡œí•„",subtitle:"í”„ë¡œí•„ ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤",sidebarItems:d,showSidebar:!0,children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})})}):e.jsxs(O,{title:"ë‚´ í”„ë¡œí•„",subtitle:"í”„ë¡œí•„ ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤",sidebarItems:d,showSidebar:!0,children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(p,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(A,{children:"ê¸°ë³¸ ì •ë³´"}),x?e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(M,{variant:"outline",onClick:r,children:"ì·¨ì†Œ"}),e.jsx(M,{onClick:w,loading:b.isPending,children:"ì €ì¥"})]}):e.jsx(M,{variant:"outline",onClick:_,children:"ìˆ˜ì •"})]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 h-20 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(te,{})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:(t==null?void 0:t.name)||"ì´ë¦„ ì—†ìŒ"}),e.jsx("p",{className:"text-gray-600",children:"í•™ìƒ"}),e.jsx(B,{variant:"success",size:"sm",children:"í™œì„±"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(K,{label:"ì´ë¦„",value:i.name,onChange:j=>a({...i,name:j.target.value}),disabled:!x}),e.jsx(K,{label:"í•™ë²ˆ",value:(t==null?void 0:t.student_id)||"",disabled:!0,helperText:"í•™ë²ˆì€ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx(K,{label:"ë°˜",value:i.class_name,onChange:j=>a({...i,class_name:j.target.value}),disabled:!x,placeholder:"ì˜ˆ: 1í•™ë…„ 1ë°˜"}),e.jsx(K,{label:"ì´ë©”ì¼",value:(n==null?void 0:n.email)||"",disabled:!0,helperText:"ì´ë©”ì¼ì€ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"ê³„ì • ì •ë³´"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ê°€ì…ì¼:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:t!=null&&t.created_at?new Date(t.created_at).toLocaleDateString():"ì•Œ ìˆ˜ ì—†ìŒ"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:t!=null&&t.updated_at?new Date(t.updated_at).toLocaleDateString():"ì•Œ ìˆ˜ ì—†ìŒ"})]})]})]})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(p,{children:[e.jsx(D,{children:e.jsx(A,{children:"AI ì±„íŒ… í†µê³„"})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:o.total}),e.jsx("div",{className:"text-sm text-gray-500",children:"ì´ ì±„íŒ… ìˆ˜"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:o.thisWeek}),e.jsx("div",{className:"text-xs text-gray-500",children:"ì´ë²ˆ ì£¼"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:o.thisMonth}),e.jsx("div",{className:"text-xs text-gray-500",children:"ì´ë²ˆ ë‹¬"})]})]})]})})]}),e.jsxs(p,{children:[e.jsx(D,{children:e.jsx(A,{children:"í•™ìŠµ í˜„í™©"})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"ì™„ë£Œí•œ í™œë™"}),e.jsx(B,{variant:"info",children:"0ê°œ"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"ì§„í–‰ ì¤‘ì¸ í™œë™"}),e.jsx(B,{variant:"warning",children:"0ê°œ"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"ë™ë£Œí‰ê°€ ì™„ë£Œ"}),e.jsx(B,{variant:"success",children:"0ê°œ"})]})]})})]}),e.jsxs(p,{children:[e.jsx(D,{children:e.jsx(A,{children:"ìµœê·¼ í™œë™"})}),e.jsx(v,{children:g&&g.length>0?e.jsx("div",{className:"space-y-3",children:g.slice(-3).map(j=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:"AI ì±„íŒ…"}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(j.created_at).toLocaleDateString()})]}),e.jsx("p",{className:"text-gray-600 text-xs truncate",children:j.message})]},j.id))}):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"ìµœê·¼ í™œë™ì´ ì—†ìŠµë‹ˆë‹¤."})})})]})]})]}),e.jsxs(p,{className:"mt-6",children:[e.jsx(D,{children:e.jsx(A,{children:"ğŸ’¡ íš¨ê³¼ì ì¸ í•™ìŠµì„ ìœ„í•œ íŒ"})}),e.jsx(v,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"AI ì±„íŒ… í™œìš©"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"â€¢ êµ¬ì²´ì ì´ê³  ëª…í™•í•œ ì§ˆë¬¸í•˜ê¸°"}),e.jsx("li",{children:"â€¢ ë‹¨ê³„ë³„ë¡œ ë‚˜ëˆ„ì–´ ì§ˆë¬¸í•˜ê¸°"}),e.jsx("li",{children:"â€¢ ì´í•´ê°€ ì•ˆ ë˜ë©´ ë‹¤ì‹œ ë¬¼ì–´ë³´ê¸°"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"ë…¼ì¦ ì‘ì„±"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"â€¢ ëª…í™•í•œ ì£¼ì¥ ì œì‹œí•˜ê¸°"}),e.jsx("li",{children:"â€¢ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ê·¼ê±° ì‚¬ìš©í•˜ê¸°"}),e.jsx("li",{children:"â€¢ ë°˜ëŒ€ ì˜ê²¬ë„ ê³ ë ¤í•˜ê¸°"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"ë™ë£Œí‰ê°€"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"â€¢ ê°ê´€ì ì´ê³  ê³µì •í•˜ê²Œ í‰ê°€í•˜ê¸°"}),e.jsx("li",{children:"â€¢ ê±´ì„¤ì ì¸ í”¼ë“œë°± ì œê³µí•˜ê¸°"}),e.jsx("li",{children:"â€¢ ìƒëŒ€ë°©ì„ ì¡´ì¤‘í•˜ëŠ” íƒœë„ ìœ ì§€í•˜ê¸°"})]})]})]})})]})]})}const re=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),ae=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253z"})}),ne=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),ie=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Pe=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})});function Ue(){const[x,y]=u.useState("chat"),[i,a]=u.useState("all"),{data:n}=T(),{data:t}=Q((n==null?void 0:n.id)||""),h=[{label:"ëŒ€ì‹œë³´ë“œ",href:"/student",icon:e.jsx(ae,{})},{label:"AI ì±„íŒ…",href:"/student/chat",icon:e.jsx(ne,{})},{label:"ë‚´ í”„ë¡œí•„",href:"/student/profile",icon:e.jsx(ie,{})},{label:"í™œë™ ê¸°ë¡",href:"/student/history",icon:e.jsx(re,{})}],b=(()=>{if(!t)return[];if(i==="all")return t;const r=new Date,w=i==="week"?new Date(r.getTime()-10080*60*1e3):new Date(r.getTime()-720*60*60*1e3);return t.filter(z=>new Date(z.created_at)>=w)})(),d=r=>{switch(r){case"all":return"ì „ì²´";case"week":return"ìµœê·¼ 1ì£¼ì¼";case"month":return"ìµœê·¼ 1ê°œì›”";default:return r}},_=e.jsx("div",{className:"flex space-x-2",children:e.jsx(M,{variant:"outline",size:"sm",children:"ë‚´ë³´ë‚´ê¸°"})});return e.jsxs(O,{title:"í™œë™ ê¸°ë¡",subtitle:"ë‚˜ì˜ í•™ìŠµ í™œë™ ê¸°ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤",headerActions:_,sidebarItems:h,showSidebar:!0,children:[e.jsx(p,{className:"mb-6",children:e.jsx(v,{padding:"none",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6",children:[{key:"chat",label:"AI ì±„íŒ… ê¸°ë¡",count:(t==null?void 0:t.length)||0},{key:"activities",label:"í™œë™ ê¸°ë¡",count:0},{key:"evaluations",label:"ë™ë£Œí‰ê°€ ê¸°ë¡",count:0}].map(r=>e.jsxs("button",{onClick:()=>y(r.key),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${x===r.key?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("span",{children:r.label}),e.jsx(B,{variant:"info",size:"sm",children:r.count})]},r.key))})})})}),e.jsx(p,{className:"mb-6",children:e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"ê¸°ê°„ í•„í„°"}),e.jsx("div",{className:"flex space-x-2",children:["all","week","month"].map(r=>e.jsx(M,{variant:i===r?"primary":"outline",size:"sm",onClick:()=>a(r),children:d(r)},r))})]})})}),x==="chat"&&e.jsxs(p,{children:[e.jsx(D,{children:e.jsx(A,{children:"AI ì±„íŒ… ê¸°ë¡"})}),e.jsx(v,{children:b.length>0?e.jsx("div",{className:"space-y-4",children:b.map(r=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Pe,{}),e.jsx("span",{className:"text-sm text-gray-600",children:new Date(r.created_at).toLocaleString()})]}),e.jsx(B,{variant:"info",size:"sm",children:"AI ì±„íŒ…"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-3",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(ie,{}),e.jsx("span",{className:"ml-2 text-sm font-medium text-blue-900",children:"ë‚´ ì§ˆë¬¸"})]}),e.jsx("p",{className:"text-blue-800 text-sm",children:r.message})]}),e.jsxs("div",{className:"bg-gray-50 border-l-4 border-gray-400 p-3",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-900",children:"AI ì‘ë‹µ"})]}),e.jsx("p",{className:"text-gray-800 text-sm whitespace-pre-wrap",children:r.response})]})]})]},r.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ne,{}),e.jsx("p",{className:"text-gray-500 mt-4",children:i==="all"?"ì•„ì§ AI ì±„íŒ… ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.":`${d(i)} ë™ì•ˆì˜ ì±„íŒ… ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.`}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"AIì™€ ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”!"})]})})]}),x==="activities"&&e.jsxs(p,{children:[e.jsx(D,{children:e.jsx(A,{children:"í™œë™ ê¸°ë¡"})}),e.jsx(v,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ae,{}),e.jsx("p",{className:"text-gray-500 mt-4",children:"ì•„ì§ ì™„ë£Œí•œ í™œë™ì´ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"í™œë™ì„ ì™„ë£Œí•˜ë©´ ì—¬ê¸°ì— ê¸°ë¡ì´ í‘œì‹œë©ë‹ˆë‹¤."})]})})]}),x==="evaluations"&&e.jsxs(p,{children:[e.jsx(D,{children:e.jsx(A,{children:"ë™ë£Œí‰ê°€ ê¸°ë¡"})}),e.jsx(v,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(re,{}),e.jsx("p",{className:"text-gray-500 mt-4",children:"ì•„ì§ ì™„ë£Œí•œ ë™ë£Œí‰ê°€ê°€ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"ë™ë£Œí‰ê°€ë¥¼ ì™„ë£Œí•˜ë©´ ì—¬ê¸°ì— ê¸°ë¡ì´ í‘œì‹œë©ë‹ˆë‹¤."})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-6",children:[e.jsx(p,{children:e.jsx(v,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:b.length}),e.jsxs("div",{className:"text-sm text-gray-600",children:[d(i)," ì±„íŒ… ìˆ˜"]})]})})}),e.jsx(p,{children:e.jsx(v,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"0"}),e.jsx("div",{className:"text-sm text-gray-600",children:"ì™„ë£Œí•œ í™œë™"})]})})}),e.jsx(p,{children:e.jsx(v,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"0"}),e.jsx("div",{className:"text-sm text-gray-600",children:"ë™ë£Œí‰ê°€ ì™„ë£Œ"})]})})})]})]})}export{He as S,Te as a,Ve as b,Oe as c,Ue as d};
